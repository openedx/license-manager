WARNING: THIS DOCUMENT IS A PROPOSAL AT THIS TIME, NONE OF THESE EVENTS ARE IMPLEMENTED YET IN THE CODE BASE.

Segment events
==============

``license-manager`` emits several Segment events of the format:

``edx.server.license-manager.license-lifecycle.<new-status>``


Possible values of the **new status** event name match the subscriptions.License lifecycle. Events are emitted when a new ``subscriptions.License`` record's ``status`` field changes from a previous value or if other data on the record is updated as detailed below: 

edx.server.license-manager.license-lifecycle.created
-----------------------------------------------------
Emitted when a ``subscriptions.License`` model with a new UUID is created

edx.server.license-manager.license-lifecycle.assigned
------------------------------------------------------
Emitted when a ``subscriptions.License`` model is assigned to a specific email address.

This event may be emitted multiple times per license if a license is re-used by an Enterprise.

The user_id field for this event will contain the user_id of the user who performed the assignment.

edx.server.license-manager.license-lifecycle.revoked
-----------------------------------------------------
Emitted when a ``subscriptions.License`` model is revoked from a specific email address.

This event may be emitted multiple times per license if a license is re-used by an Enterprise.

The user_id field for this event will contain the user_id of the user who performed the revocation.


edx.server.license-manager.license-lifecycle.activated
-------------------------------------------------------
Emitted when an assigned ``subscriptions.License`` model is activated.

Activation refers to the high level process of a learner acknowledging a license has been assigned to them and then using an edX learner account that is linked to this license. 

This event may be emitted multiple times per license if a license is re-used by an Enterprise.


edx.server.license-manager.license-lifecycle.renewed
-----------------------------------------------------
Emitted when an existing ``subscriptions.License`` is replaced with a new ``subscriptions.License``. Renewed licenses do not necessarily have to have an assigned learner.

The license_uuid field for this event contains the new license generated by the renewal process. 

The previous_license_uuid field for this event contains the license that is being replaced as part of the renewal event.


edx.server.license-manager.license-lifecycle.expired
-----------------------------------------------------
Emitted when an existing ``subscriptions.License`` is marked as expired.

edx.server.license-manager.license-lifecycle.deleted
-----------------------------------------------------
Emitted when a ``subscriptions.License`` model is deleted from the database.


Event Nested Data Field Specification
-------------------------------------

All events contains these properties, though some may be empty:

- **user_id**: The LMS User id of the user that triggered this event. In some cases, this may be a worker user id. 

- **license_uuid**: The UUID linked to this license and storing in the License Manager DB. This value is always present.

- **previous_license_uuid**: The UUID linked to the previous license that this license is a renewal for. Non-empty only on after the edx.server.license-manager.license-lifecycle.renewed event has occurred.

- **assigned_date**: Formatted ISO-8601 Date String representing the date this license was most recently assigned to the assigned_email. May be empty.

- **activation_date**: Formatted ISO-8601 Date String  this license was most recently activated for the assigned_email. May be empty.

- **assigned_lms_user_id**: The LMS User id of the user that this license 'belongs to'. May be empty if this license is not activated yet.

- **assigned_email**: The email assigned to this license. Will be empty if this license is not assigned to a learner yet.

- **enterprise_customer_uuid**: The Enterprise Customer UUID associated with this license. 

- **enterprise_customer_slug**: The Enterprise Customer slug associated with the license. Can be easily used in event for reconstructing any Enterprise portal URL links needed (e.g. in a Braze CTA)
 
- **expiration_processed**: Boolean value of License 'expiration_processed' field, may be True or False. True means a license is expired.

- **customer_agreement_uuid**: The active Customer Agreement UUID that this license is linked to.
